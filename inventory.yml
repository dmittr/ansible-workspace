all:
  vars:
    ansible_become_password: "{{ vault_ansible_become_password }}"
    ansible_ssh_private_key_file: "~/.ssh/id_ed25519"
    tg_notify_chat_id: "{{ vault_tg_notify_chat_id }}"
    tg_notify_bot_id: "{{ vault_tg_notify_bot_id }}"
    firewalld_default_zone: "drop"
    firewalld_interfaces:
      - { interface: "docker0", zone: "trusted", state: "enabled" }
      - { interface: "wg-kube", zone: "trusted", state: "enabled" }
    wireguard: "{{ vault_wireguard | from_yaml }}"
    k3s_token: "{{vault_k3s_token}}"
    k3s_primary_master_ip: "192.168.99.1"
    k3s_primary_master_name: "server.example.com"


  hosts:
    server.example.com:
      ansible_host: 192.168.1.2
      ansible_user: karasik
      ansible_port: 33322
      # K3s configuration
      k3s_node_ip: 192.168.99.1
      k3s_node_type: mixed  # master, mixed, worker
      k3s_node_labels:
        - "topology.kubernetes.io/zone=dc1"
        - "node.kubernetes.io/instance-type=baremetal"
      firewalld_default_allowed_ports:
        - { port: '80', proto: 'tcp' }
        - { port: '443', proto: 'tcp' }
    vps-somewhere:
      ansible_host: 1.1.1.1
      ansible_user: karasik
      ansible_port: 33322
      # K3s configuration
      k3s_node_ip: 192.168.99.2
      k3s_node_type: master  # dedicated control plane, no workloads
      k3s_node_labels: []
      firewalld_default_allowed_ports:
        - { port: '80', proto: 'tcp' }
        - { port: '443', proto: 'tcp' }

  children:
    servers:
      hosts:
        server.example.com:
        vps-somewhere:

    baremetal:
      hosts:
        server.example.com:

    vps:
      hosts:
        vps-somewhere:

    webservers:
      children:
        servers: